Version 4
SHEET 1 4532 3124
WIRE 3456 -208 1280 -208
WIRE 352 16 240 16
WIRE 416 16 352 16
WIRE 512 16 480 16
WIRE 640 16 512 16
WIRE 1792 16 1472 16
WIRE 1936 16 1792 16
WIRE 2048 16 1936 16
WIRE 2416 16 2144 16
WIRE 2608 16 2416 16
WIRE 2800 16 2688 16
WIRE 2928 16 2800 16
WIRE 3088 16 2992 16
WIRE 3120 16 3088 16
WIRE 3248 16 3200 16
WIRE 3456 16 3456 -208
WIRE 3456 16 3248 16
WIRE 240 48 240 16
WIRE 1472 64 1472 16
WIRE -16 80 -64 80
WIRE 128 80 64 80
WIRE 2416 80 2416 16
WIRE 2800 80 2800 16
WIRE 128 112 128 80
WIRE 3456 112 3456 16
WIRE -64 128 -64 80
WIRE 640 128 640 80
WIRE 240 144 240 128
WIRE 288 144 240 144
WIRE 240 160 240 144
WIRE 288 160 288 144
WIRE 1472 208 1472 144
WIRE 1792 224 1792 16
WIRE 1936 224 1936 16
WIRE -64 240 -64 208
WIRE 128 240 128 192
WIRE 128 240 -64 240
WIRE 2416 240 2416 144
WIRE 2800 240 2800 144
WIRE 2800 240 2416 240
WIRE 3456 240 3456 192
WIRE 3456 240 2800 240
WIRE 240 272 240 240
WIRE 288 272 240 272
WIRE 416 272 288 272
WIRE 512 272 512 16
WIRE 512 272 480 272
WIRE 2416 288 2416 240
WIRE 352 304 352 16
WIRE 1936 336 1936 304
WIRE 2048 336 1936 336
WIRE 496 368 352 368
WIRE 1936 368 1936 336
WIRE 2048 368 2048 336
WIRE 288 384 288 272
WIRE 288 384 256 384
WIRE 256 400 256 384
WIRE 1792 416 1792 304
WIRE 1872 416 1792 416
WIRE 368 432 336 432
WIRE 496 432 496 368
WIRE 496 432 432 432
WIRE 576 432 496 432
WIRE 688 432 640 432
WIRE 688 448 688 432
WIRE 848 448 688 448
WIRE 2128 448 2128 64
WIRE 2128 448 2048 448
WIRE 2048 464 2048 448
WIRE -624 512 -928 512
WIRE 336 528 336 432
WIRE 336 528 208 528
WIRE 1792 528 1792 416
WIRE 848 560 848 512
WIRE 848 560 784 560
WIRE -928 576 -928 512
WIRE 784 576 784 560
WIRE 848 576 848 560
WIRE 1728 576 1392 576
WIRE 2048 576 2048 544
WIRE 336 592 336 528
WIRE 368 592 336 592
WIRE 496 592 432 592
WIRE 576 592 496 592
WIRE 688 592 688 448
WIRE 688 592 640 592
WIRE 256 656 256 464
WIRE 496 656 496 592
WIRE 496 656 256 656
WIRE 1792 656 1792 624
WIRE 1856 656 1792 656
WIRE 1936 656 1936 464
WIRE 1936 656 1856 656
WIRE 208 688 208 528
WIRE 848 688 848 640
WIRE 848 688 208 688
WIRE 1856 688 1856 656
WIRE -928 704 -928 656
WIRE 3088 768 3088 16
WIRE 3088 768 1728 768
WIRE -624 832 -624 512
WIRE -624 832 -656 832
WIRE -272 832 -624 832
WIRE 128 832 -272 832
WIRE 528 832 128 832
WIRE 1472 832 528 832
WIRE 2112 832 1472 832
WIRE 2848 832 2112 832
WIRE 3248 896 3248 16
WIRE 3248 896 1824 896
WIRE 2544 928 2432 928
WIRE 2432 976 2432 928
WIRE 32 1008 16 1008
WIRE 256 1008 112 1008
WIRE -384 1040 -448 1040
WIRE -144 1040 -304 1040
WIRE 1824 1040 1824 896
WIRE 1856 1040 1824 1040
WIRE 1984 1040 1936 1040
WIRE 2016 1040 1984 1040
WIRE 2288 1040 2096 1040
WIRE 2544 1040 2544 928
WIRE 2688 1040 2624 1040
WIRE 2736 1040 2688 1040
WIRE 3024 1040 2816 1040
WIRE 16 1072 16 1008
WIRE 144 1072 16 1072
WIRE 256 1072 256 1008
WIRE 256 1072 208 1072
WIRE 16 1104 16 1072
WIRE 32 1104 16 1104
WIRE 2432 1104 2432 1056
WIRE 2112 1136 2112 832
WIRE 2848 1136 2848 832
WIRE -272 1152 -272 832
WIRE 128 1152 128 832
WIRE 528 1152 528 832
WIRE 1984 1152 1984 1040
WIRE 2080 1152 1984 1152
WIRE 2688 1152 2688 1040
WIRE 2816 1152 2688 1152
WIRE -448 1168 -448 1040
WIRE -304 1168 -448 1168
WIRE 32 1168 32 1104
WIRE 32 1168 0 1168
WIRE 96 1168 32 1168
WIRE 496 1168 400 1168
WIRE 2288 1168 2288 1040
WIRE 2288 1168 2144 1168
WIRE 2528 1168 2288 1168
WIRE 3024 1168 3024 1040
WIRE 3024 1168 2880 1168
WIRE 3584 1168 3024 1168
WIRE -144 1184 -144 1040
WIRE -144 1184 -240 1184
WIRE -96 1184 -144 1184
WIRE 0 1184 0 1168
WIRE 0 1184 -16 1184
WIRE 256 1184 256 1072
WIRE 256 1184 160 1184
WIRE 288 1184 256 1184
WIRE 592 1184 560 1184
WIRE 672 1184 656 1184
WIRE 1392 1184 1392 576
WIRE 1392 1184 672 1184
WIRE 1728 1184 1728 768
WIRE 1856 1184 1728 1184
WIRE 2000 1184 1952 1184
WIRE 2080 1184 2000 1184
WIRE 2528 1184 2528 1168
WIRE 2544 1184 2528 1184
WIRE 2736 1184 2624 1184
WIRE 2816 1184 2736 1184
WIRE -448 1200 -448 1168
WIRE -304 1200 -336 1200
WIRE 96 1200 32 1200
WIRE 288 1200 288 1184
WIRE 496 1200 288 1200
WIRE -144 1232 -144 1184
WIRE 32 1232 32 1200
WIRE 2000 1232 2000 1184
WIRE 2736 1232 2736 1184
WIRE -448 1296 -448 1264
WIRE -336 1344 -336 1200
WIRE -144 1344 -144 1312
WIRE -144 1344 -336 1344
WIRE -144 1360 -144 1344
WIRE 32 1376 32 1312
WIRE 2000 1376 2000 1312
WIRE 2736 1376 2736 1312
WIRE -144 1440 -144 1424
WIRE -144 1488 -144 1440
WIRE -272 1504 -272 1216
WIRE -272 1504 -1040 1504
WIRE -272 1536 -272 1504
WIRE 128 1536 128 1216
WIRE 128 1536 -272 1536
WIRE 528 1536 528 1216
WIRE 528 1536 128 1536
WIRE 784 1536 528 1536
WIRE 2112 1536 2112 1200
WIRE 2112 1536 784 1536
WIRE 2848 1536 2848 1200
WIRE 2848 1536 2112 1536
WIRE -1040 1584 -1040 1504
WIRE -656 1712 -656 832
WIRE -48 1712 -656 1712
WIRE -1040 1744 -1040 1664
WIRE 3920 1744 528 1744
WIRE 1472 1792 1472 832
WIRE 2608 1792 1472 1792
WIRE 3184 1792 2608 1792
WIRE 3296 1792 3184 1792
WIRE 3536 1792 3296 1792
WIRE 3872 1792 3536 1792
WIRE -352 1904 -624 1904
WIRE -144 1904 -272 1904
WIRE 16 1904 -144 1904
WIRE 160 1904 96 1904
WIRE 3184 1920 3184 1792
WIRE 3296 1920 3296 1792
WIRE 2608 1984 2608 1792
WIRE -48 2000 -48 1712
WIRE 1280 2000 1280 -208
WIRE 2576 2000 1280 2000
WIRE -144 2016 -144 1904
WIRE -80 2016 -144 2016
WIRE 2832 2016 2640 2016
WIRE 160 2032 160 1904
WIRE 160 2032 -16 2032
WIRE 528 2032 528 1744
WIRE 528 2032 160 2032
WIRE 2576 2032 2400 2032
WIRE 2832 2032 2832 2016
WIRE -624 2048 -624 1984
WIRE -352 2048 -496 2048
WIRE -144 2048 -272 2048
WIRE -80 2048 -144 2048
WIRE 2400 2064 2400 2032
WIRE 3184 2064 3184 1984
WIRE 3296 2064 3296 2000
WIRE 3296 2064 3184 2064
WIRE 3584 2064 3584 1168
WIRE 3920 2064 3920 1744
WIRE 3536 2080 3536 1792
WIRE 3872 2080 3872 1792
WIRE 3184 2096 3184 2064
WIRE -144 2112 -144 2048
WIRE -48 2144 -48 2064
WIRE 560 2144 -48 2144
WIRE 784 2144 784 1536
WIRE 784 2144 560 2144
WIRE 2832 2144 2832 2112
WIRE 2976 2144 2832 2144
WIRE 3120 2144 3056 2144
WIRE 2832 2176 2832 2144
WIRE 2400 2192 2400 2144
WIRE -144 2240 -144 2192
WIRE 2832 2272 2832 2256
WIRE 3184 2272 3184 2192
WIRE 3184 2272 2832 2272
WIRE 3296 2272 3296 2064
WIRE 3536 2272 3536 2128
WIRE 3536 2272 3296 2272
WIRE 3872 2272 3872 2128
WIRE 3872 2272 3536 2272
WIRE -496 2288 -496 2048
WIRE 1280 2288 1280 2000
WIRE 1280 2288 -496 2288
WIRE 2832 2304 2832 2272
WIRE 3584 2400 3584 2144
WIRE 3760 2400 3584 2400
WIRE 3920 2400 3920 2144
WIRE 3920 2400 3760 2400
WIRE 560 2416 560 2144
WIRE 2608 2416 2608 2048
WIRE 2608 2416 560 2416
WIRE 3760 2432 3760 2400
WIRE 400 2976 400 1168
WIRE 3760 2976 3760 2432
WIRE 3760 2976 400 2976
FLAG 288 160 0
FLAG 640 128 0
FLAG 784 576 0
FLAG -448 1296 0
FLAG -144 1488 0
FLAG 32 1376 0
FLAG 400 1168 PWMiN
IOPIN 400 1168 In
FLAG 1856 688 0
FLAG 2416 288 0
FLAG 2000 1376 0
FLAG 2736 1376 0
FLAG 2432 1104 0
FLAG 3024 1168 current_out
IOPIN 3024 1168 Out
FLAG -144 2240 0
FLAG -624 2048 0
FLAG -1040 1744 0
FLAG -928 704 0
FLAG 2400 2192 0
FLAG 2832 2304 0
FLAG 3760 2432 PWM_OUT
IOPIN 3760 2432 Out
FLAG 1472 208 0
FLAG 2048 576 0
SYMBOL voltage -64 112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value SINE(0 325.27 50)
SYMBOL ind2 112 96 R0
SYMATTR InstName L1
SYMATTR Value 10m
SYMATTR Type ind
SYMBOL ind2 256 144 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L2
SYMATTR Value 0.025m
SYMATTR Type ind
SYMBOL ind2 256 256 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L3
SYMATTR Value 0.025m
SYMATTR Type ind
SYMBOL diode 416 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMBOL diode 416 288 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMBOL cap 624 16 R0
SYMATTR InstName C1
SYMATTR Value 3300µ
SYMBOL res 80 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 1
SYMBOL diode 368 448 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMBOL diode 576 448 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMBOL diode 368 608 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D5
SYMBOL diode 576 608 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D6
SYMBOL cap 336 304 R0
SYMATTR InstName C2
SYMATTR Value 1000µ
SYMBOL cap 240 400 R0
SYMATTR InstName C3
SYMATTR Value 1000µ
SYMBOL cap 832 448 R0
SYMATTR InstName C4
SYMATTR Value 3300µ
SYMBOL cap 832 576 R0
SYMATTR InstName C5
SYMATTR Value 3300µ
SYMBOL OpAmps\\RH27C -272 1120 R0
SYMATTR InstName U1
SYMBOL OpAmps\\RH27C 128 1120 R0
SYMATTR InstName U2
SYMBOL OpAmps\\RH27C 528 1120 R0
SYMATTR InstName U3
SYMBOL res -288 1024 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 39k
SYMBOL cap -464 1200 R0
SYMATTR InstName C6
SYMATTR Value 20n
SYMBOL res -160 1216 R0
SYMATTR InstName R3
SYMATTR Value 33k
SYMBOL res -160 1344 R0
SYMATTR InstName R4
SYMATTR Value 27k
SYMBOL res 0 1168 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 2.2k
SYMBOL res 128 992 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL cap 208 1056 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C7
SYMATTR Value 220n
SYMBOL res 16 1216 R0
SYMATTR InstName R7
SYMATTR Value 33k
SYMBOL npn 1728 528 R0
SYMATTR InstName Q1
SYMBOL npn 1872 368 R0
SYMATTR InstName Q2
SYMBOL res 1776 208 R0
SYMATTR InstName R8
SYMATTR Value 33k
SYMBOL res 1920 208 R0
SYMATTR InstName R9
SYMATTR Value 33k
SYMBOL schottky 2432 144 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D7
SYMATTR Value MBR735
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL ind 2592 32 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L4
SYMATTR Value 200m
SYMBOL cap 2784 80 R0
SYMATTR InstName C8
SYMATTR Value 100µ
SYMBOL schottky 2928 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D8
SYMATTR Value 30BQ060
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 3104 32 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R10
SYMATTR Value 1
SYMBOL Misc\\battery 3456 96 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 132 Left 2
SYMATTR SpiceLine Rser=1
SYMATTR InstName V3
SYMATTR Value PULSE(5.6 13.3 0 150m 0 150m 300m 1)
SYMBOL OpAmps\\RH27C 2112 1104 R0
SYMATTR InstName U4
SYMBOL OpAmps\\RH27C 2848 1104 R0
SYMATTR InstName U5
SYMBOL res 1840 1200 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res 1840 1056 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL res 2000 1056 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R13
SYMATTR Value 33k
SYMBOL res 1984 1216 R0
SYMATTR InstName R14
SYMATTR Value 33k
SYMBOL res 2640 1168 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 220
SYMBOL res 2640 1024 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 220
SYMBOL res 2832 1024 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 5k
SYMBOL res 2720 1328 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R18
SYMATTR Value 5k
SYMBOL voltage 2432 960 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 3.3
SYMBOL OpAmps\\RH27C -48 1968 R0
SYMATTR InstName U6
SYMBOL res -256 1888 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 1K
SYMBOL res -256 2032 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 1K
SYMBOL res 112 1888 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 1K
SYMBOL res -128 2208 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R22
SYMATTR Value 1K
SYMBOL voltage -624 1888 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 13.3
SYMBOL voltage -928 560 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 15
SYMBOL voltage -1040 1680 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value 15
SYMBOL res 688 1168 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 1K
SYMBOL voltage 2400 2048 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 13.3
SYMBOL OpAmps\\RH27C 2608 1952 R0
SYMATTR InstName U7
SYMBOL res 2816 2016 R0
SYMATTR InstName R24
SYMATTR Value 33k
SYMBOL res 2816 2160 R0
SYMATTR InstName R25
SYMATTR Value 33k
SYMBOL res 3072 2128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 1k
SYMBOL npn 3120 2096 R0
SYMATTR InstName Q3
SYMBOL diode 3200 1984 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D9
SYMBOL res 3280 1904 R0
SYMATTR InstName R27
SYMATTR Value 10k
SYMBOL sw 3584 2160 M180
SYMATTR InstName S1
SYMATTR Value NO
SYMBOL sw 3920 2160 M180
SYMATTR InstName S2
SYMATTR Value NC
SYMBOL voltage 1472 48 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value 15
SYMBOL nmos 2048 64 R270
SYMATTR InstName M1
SYMATTR Value FDS4410
SYMBOL res 2032 352 R0
SYMATTR InstName R28
SYMATTR Value 10k
SYMBOL res 2032 448 R0
SYMATTR InstName R29
SYMATTR Value 90k
TEXT 88 24 Left 2 !K L1 L2 L3 1
TEXT -96 320 Left 2 !.tran 0 300m 0
TEXT 368 -72 Left 2 ;POWER SUPPLY
TEXT -504 792 Left 2 ;PWM_GEENERATION
TEXT 1800 -104 Left 2 ;BUCK_CONVERTER
TEXT 2280 1432 Left 2 ;Here_3.3V_is_obtained_by_zener_diode
TEXT 1488 848 Left 2 ;CURRENT_CONTROL_CIRCUIT
TEXT -784 1672 Left 2 ;CONSTANT_VOLTAGE
TEXT 3992 1920 Left 2 !.model NO SW(Ron=1m Roff=10Meg Vt=5V)
TEXT 4000 1968 Left 2 !.model NC SW(Ron=100Meg Roff=1m Vt=5V)
RECTANGLE Normal 1120 784 -128 -48 1
RECTANGLE Normal -512 816 1152 1664 1
RECTANGLE Normal 3360 816 1568 -64 2
RECTANGLE Normal 3232 1584 1584 864 2
RECTANGLE Normal 1392 2480 -736 1696 2
